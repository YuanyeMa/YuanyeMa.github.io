<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>TensorFlow on Yuanye Ma's Blog</title><link>/tags/tensorflow/</link><description>Recent content in TensorFlow on Yuanye Ma's Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><managingEditor>yuanye.ma@qq.com (Yuanye Ma)</managingEditor><webMaster>yuanye.ma@qq.com (Yuanye Ma)</webMaster><lastBuildDate>Sat, 20 Jul 2019 16:01:23 +0800</lastBuildDate><atom:link href="/tags/tensorflow/index.xml" rel="self" type="application/rss+xml"/><item><title>tensorboardX的用法</title><link>/post/programing/tensorboard/</link><pubDate>Sat, 20 Jul 2019 16:01:23 +0800</pubDate><author>yuanye.ma@qq.com (Yuanye Ma)</author><guid>/post/programing/tensorboard/</guid><description>&lt;h1 id="pytorchtensorboardx">pytorch+tensorboardX&lt;/h1>
&lt;p>简单总结一下tensorboardX的用法。&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-1">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-1"> 1&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-2">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-2"> 2&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-3">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-3"> 3&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-4">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-4"> 4&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-5">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-5"> 5&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-6">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-6"> 6&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-7">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-7"> 7&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-8">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-8"> 8&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-9">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-9"> 9&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-10">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-10">10&lt;/a>
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">import&lt;/span> &lt;span style="color:#0e84b5;font-weight:bold">numpy&lt;/span> &lt;span style="color:#007020;font-weight:bold">as&lt;/span> &lt;span style="color:#0e84b5;font-weight:bold">np&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">from&lt;/span> &lt;span style="color:#0e84b5;font-weight:bold">tensorboardX&lt;/span> &lt;span style="color:#007020;font-weight:bold">import&lt;/span> SummaryWriter
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>write &lt;span style="color:#666">=&lt;/span> SummaryWriter()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">for&lt;/span> epoch &lt;span style="color:#007020;font-weight:bold">in&lt;/span> &lt;span style="color:#007020">range&lt;/span>(&lt;span style="color:#40a070">100&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> write&lt;span style="color:#666">.&lt;/span>add_scalar(&lt;span style="color:#4070a0">&amp;#39;scale/test&amp;#39;&lt;/span>, np&lt;span style="color:#666">.&lt;/span>random&lt;span style="color:#666">.&lt;/span>rand(), epoch)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> write&lt;span style="color:#666">.&lt;/span>add_scalars(&lt;span style="color:#4070a0">&amp;#39;scale/scales_test&amp;#39;&lt;/span>, {&lt;span style="color:#4070a0">&amp;#39;xsinx&amp;#39;&lt;/span>:epoch&lt;span style="color:#666">*&lt;/span>np&lt;span style="color:#666">.&lt;/span>sin(epoch), &lt;span style="color:#4070a0">&amp;#39;xcosx&amp;#39;&lt;/span> : epoch&lt;span style="color:#666">*&lt;/span>np&lt;span style="color:#666">.&lt;/span>cos(epoch)}, epoch)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>write&lt;span style="color:#666">.&lt;/span>close()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在终端中运行上边代码:&lt;code>python ./tensorboard_scales.py&lt;/code>，查看代码目录下多了一个&lt;code>runs&lt;/code>的目录，里边保存的就是代码运行时的数据。&lt;/p>
&lt;p>&lt;img src="/post/programing/tensorboard/01.png" alt="01">&lt;/p>
&lt;p>再使用&lt;code>tensorboard --logdir runs&lt;/code>,在浏览器地址栏输入&lt;code>ip_address:6006&lt;/code>就能看到图像。&lt;/p>
&lt;p>&lt;img src="/post/programing/tensorboard/04.png" alt="04">&lt;/p>
&lt;p>此时再次运行代码，再查看目录结构，会发现又多了一些目录，这是因为tensorboard会保存几个历史版本。这个功能很好用，可以通过点击左下角的复选框勾选要对比的曲线，进而对比模型的性能。&lt;/p>
&lt;p>&lt;img src="/post/programing/tensorboard/02.png" alt="02">&lt;/p>
&lt;p>试试&lt;code>graph&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-1">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-1"> 1&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-2">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-2"> 2&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-3">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-3"> 3&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-4">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-4"> 4&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-5">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-5"> 5&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-6">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-6"> 6&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-7">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-7"> 7&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-8">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-8"> 8&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-9">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-9"> 9&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-10">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-10">10&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-11">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-11">11&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-12">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-12">12&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-13">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-13">13&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-14">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-14">14&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-15">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-15">15&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-16">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-16">16&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-17">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-17">17&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-18">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-18">18&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-19">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-19">19&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-20">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-20">20&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-21">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-21">21&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-22">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-22">22&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-23">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-23">23&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-24">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-24">24&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-25">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-25">25&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-26">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-26">26&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-27">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-27">27&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-28">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-28">28&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-29">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-29">29&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-30">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-30">30&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-31">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-31">31&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-32">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-32">32&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-33">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-33">33&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-34">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-34">34&lt;/a>
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">import&lt;/span> &lt;span style="color:#0e84b5;font-weight:bold">torch&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">import&lt;/span> &lt;span style="color:#0e84b5;font-weight:bold">torch.nn&lt;/span> &lt;span style="color:#007020;font-weight:bold">as&lt;/span> &lt;span style="color:#0e84b5;font-weight:bold">nn&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">import&lt;/span> &lt;span style="color:#0e84b5;font-weight:bold">torch.nn.functional&lt;/span> &lt;span style="color:#007020;font-weight:bold">as&lt;/span> &lt;span style="color:#0e84b5;font-weight:bold">F&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">from&lt;/span> &lt;span style="color:#0e84b5;font-weight:bold">tensorboardX&lt;/span> &lt;span style="color:#007020;font-weight:bold">import&lt;/span> SummaryWriter
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">class&lt;/span> &lt;span style="color:#0e84b5;font-weight:bold">Net1&lt;/span>(nn&lt;span style="color:#666">.&lt;/span>Module):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">def&lt;/span> &lt;span style="color:#06287e">__init__&lt;/span>(&lt;span style="color:#007020">self&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020">super&lt;/span>(Net1, &lt;span style="color:#007020">self&lt;/span>)&lt;span style="color:#666">.&lt;/span>&lt;span style="color:#06287e">__init__&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020">self&lt;/span>&lt;span style="color:#666">.&lt;/span>conv1 &lt;span style="color:#666">=&lt;/span> nn&lt;span style="color:#666">.&lt;/span>Conv2d(&lt;span style="color:#40a070">1&lt;/span>, &lt;span style="color:#40a070">10&lt;/span>, kernel_size&lt;span style="color:#666">=&lt;/span>&lt;span style="color:#40a070">5&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020">self&lt;/span>&lt;span style="color:#666">.&lt;/span>conv2 &lt;span style="color:#666">=&lt;/span> nn&lt;span style="color:#666">.&lt;/span>Conv2d(&lt;span style="color:#40a070">10&lt;/span>, &lt;span style="color:#40a070">20&lt;/span>, kernel_size&lt;span style="color:#666">=&lt;/span>&lt;span style="color:#40a070">5&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020">self&lt;/span>&lt;span style="color:#666">.&lt;/span>conv2_drop &lt;span style="color:#666">=&lt;/span> nn&lt;span style="color:#666">.&lt;/span>Dropout2d()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020">self&lt;/span>&lt;span style="color:#666">.&lt;/span>fc1 &lt;span style="color:#666">=&lt;/span> nn&lt;span style="color:#666">.&lt;/span>Linear(&lt;span style="color:#40a070">320&lt;/span>, &lt;span style="color:#40a070">50&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020">self&lt;/span>&lt;span style="color:#666">.&lt;/span>fc2 &lt;span style="color:#666">=&lt;/span> nn&lt;span style="color:#666">.&lt;/span>Linear(&lt;span style="color:#40a070">50&lt;/span>, &lt;span style="color:#40a070">10&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020">self&lt;/span>&lt;span style="color:#666">.&lt;/span>bn &lt;span style="color:#666">=&lt;/span> nn&lt;span style="color:#666">.&lt;/span>BatchNorm2d(&lt;span style="color:#40a070">20&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">def&lt;/span> &lt;span style="color:#06287e">forward&lt;/span>(&lt;span style="color:#007020">self&lt;/span>, x):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> x &lt;span style="color:#666">=&lt;/span> F&lt;span style="color:#666">.&lt;/span>max_pool2d(&lt;span style="color:#007020">self&lt;/span>&lt;span style="color:#666">.&lt;/span>conv1(x), &lt;span style="color:#40a070">2&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> x &lt;span style="color:#666">=&lt;/span> F&lt;span style="color:#666">.&lt;/span>relu(x) &lt;span style="color:#666">+&lt;/span> F&lt;span style="color:#666">.&lt;/span>relu(&lt;span style="color:#666">-&lt;/span>x)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> x &lt;span style="color:#666">=&lt;/span> F&lt;span style="color:#666">.&lt;/span>relu(F&lt;span style="color:#666">.&lt;/span>max_pool2d(&lt;span style="color:#007020">self&lt;/span>&lt;span style="color:#666">.&lt;/span>conv2_drop(&lt;span style="color:#007020">self&lt;/span>&lt;span style="color:#666">.&lt;/span>conv2(x)), &lt;span style="color:#40a070">2&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> x &lt;span style="color:#666">=&lt;/span> &lt;span style="color:#007020">self&lt;/span>&lt;span style="color:#666">.&lt;/span>bn(x)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> x &lt;span style="color:#666">=&lt;/span> x&lt;span style="color:#666">.&lt;/span>view(&lt;span style="color:#666">-&lt;/span>&lt;span style="color:#40a070">1&lt;/span>, &lt;span style="color:#40a070">320&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> x &lt;span style="color:#666">=&lt;/span> F&lt;span style="color:#666">.&lt;/span>relu(&lt;span style="color:#007020">self&lt;/span>&lt;span style="color:#666">.&lt;/span>fc1(x))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> x &lt;span style="color:#666">=&lt;/span> F&lt;span style="color:#666">.&lt;/span>dropout(x, training&lt;span style="color:#666">=&lt;/span>&lt;span style="color:#007020">self&lt;/span>&lt;span style="color:#666">.&lt;/span>training)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> x &lt;span style="color:#666">=&lt;/span> &lt;span style="color:#007020">self&lt;/span>&lt;span style="color:#666">.&lt;/span>fc2(x)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> x &lt;span style="color:#666">=&lt;/span> F&lt;span style="color:#666">.&lt;/span>softmax(x, dim&lt;span style="color:#666">=&lt;/span>&lt;span style="color:#40a070">1&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">return&lt;/span> x
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dummy_input &lt;span style="color:#666">=&lt;/span> torch&lt;span style="color:#666">.&lt;/span>rand(&lt;span style="color:#40a070">13&lt;/span>, &lt;span style="color:#40a070">1&lt;/span>, &lt;span style="color:#40a070">28&lt;/span>, &lt;span style="color:#40a070">28&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>model &lt;span style="color:#666">=&lt;/span> Net1()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">with&lt;/span> SummaryWriter(comment&lt;span style="color:#666">=&lt;/span>&lt;span style="color:#4070a0">&amp;#39;Net1&amp;#39;&lt;/span>) &lt;span style="color:#007020;font-weight:bold">as&lt;/span> w:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> w&lt;span style="color:#666">.&lt;/span>add_graph(model, (dummy_input,))
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在运行的时候报错了。&lt;/p>
&lt;p>&lt;img src="/post/programing/tensorboard/error.png" alt="error">&lt;/p>
&lt;p>上网搜索了一番说是&lt;code>pytorch&lt;/code>版本的问题，为了跑写好的强化学习的代码，我用的是比较老的&lt;code>0.4.0&lt;/code>版本的，回头有机会测一下&lt;code>pytorch 1.0+&lt;/code>的看可不可以用。&lt;/p>
&lt;h2 id="总结一下tensorboardx的用法">总结一下TensorboardX的用法&lt;/h2>
&lt;ul>
&lt;li>声明一个&lt;code>SummaryWriter()&lt;/code>对象，&lt;code>log_dir&lt;/code>参数能指定log文件保存的路径。&lt;/li>
&lt;li>然后使用&lt;code>add_xxx()&lt;/code>函数向log中添加内容，&lt;code>xxx&lt;/code>可以是&lt;code>scalar&lt;/code>, &lt;code>image&lt;/code>, &lt;code>figure&lt;/code>, &lt;code>histogram&lt;/code>, &lt;code>audio&lt;/code>, &lt;code>text&lt;/code>, &lt;code>graph&lt;/code>, &lt;code>onnx_graph&lt;/code>, &lt;code>embedding&lt;/code>, &lt;code>pr_curve&lt;/code>, &lt;code>mesh&lt;/code>, &lt;code>hyper-parameters&lt;/code> and &lt;code>video&lt;/code>，&lt;a href="https://github.com/lanpa/tensorboardX">详情参见&lt;/a>或者&lt;a href="https://tensorboardx.readthedocs.io/en/latest/tensorboard.html">tensorboardX&lt;/a>。&lt;/li>
&lt;li>关闭&lt;code>SummaryWriter()&lt;/code>对象&lt;/li>
&lt;li>使用&lt;code>tensorboard --logdir&lt;/code>命令启动&lt;code>tensorboard&lt;/code>&lt;/li>
&lt;li>在浏览器里查看输出。&lt;/li>
&lt;/ul>
&lt;h1 id="tensorflowtensorboard">TensorFlow+TensorBoard&lt;/h1>
&lt;p>&lt;a href="https://blog.csdn.net/sinat_33761963/article/details/62433234">参考这篇blog&lt;/a>&lt;/p>
&lt;h2 id="总结一下使用的步骤">总结一下使用的步骤&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>建立一个计算图（Graph）&lt;/p>
&lt;/li>
&lt;li>
&lt;p>确定要在Graph中的哪些节点放置summary operations（即要在tensorboard中观察哪些数据）&lt;/p>
&lt;ol>
&lt;li>&lt;code>tf.summary.scalar&lt;/code> - 记录标量&lt;/li>
&lt;li>&lt;code>tf.summary.histogram&lt;/code> - 记录数据的直方图&lt;/li>
&lt;li>&lt;code>tf.summary.image&lt;/code> - 记录图片&lt;/li>
&lt;li>&lt;code>tf.summary.audio&lt;/code> - 记录音频&lt;/li>
&lt;li>&lt;code>tf.summary.graph&lt;/code> - 记录计算图结构&lt;/li>
&lt;li>&lt;code>tf.summary.distribution&lt;/code> - 记录数据分布&lt;/li>
&lt;li>&lt;code>tf.summary.embeddings&lt;/code> - 记录嵌入向量&lt;/li>
&lt;li>&lt;code>tf.summary.text&lt;/code> - 记录文本&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>
&lt;p>使用&lt;code>tf.summary.merge_all&lt;/code>将所有summary operations合并为一个operation&lt;/p>
&lt;/li>
&lt;li>
&lt;p>运行3中合并之后的operation:&lt;code>summary = sess.run(all_summary)&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>声明一个&lt;code>FileWriter&lt;/code>对象：&lt;code>writer = tf.summary.FileWriter(&amp;quot;./train&amp;quot;, graph)&lt;/code> #如果有graph参数，可以在tensorboard中查看graph的结构。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>使用&lt;code>tf.summary.FileWriter&lt;/code>将数据写入本地磁盘: &lt;code>writer.add_summary(summary, steps)&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>运行程序后，使用&lt;code>tensorboard --logdir=logdir&lt;/code>启动tensorboard,然后在浏览器中查看。&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="参考代码">参考代码&lt;/h2>
&lt;div class="highlight">&lt;div style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-1">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-1"> 1&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-2">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-2"> 2&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-3">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-3"> 3&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-4">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-4"> 4&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-5">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-5"> 5&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-6">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-6"> 6&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-7">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-7"> 7&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-8">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-8"> 8&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-9">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-9"> 9&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-10">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-10"> 10&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-11">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-11"> 11&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-12">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-12"> 12&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-13">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-13"> 13&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-14">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-14"> 14&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-15">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-15"> 15&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-16">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-16"> 16&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-17">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-17"> 17&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-18">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-18"> 18&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-19">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-19"> 19&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-20">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-20"> 20&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-21">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-21"> 21&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-22">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-22"> 22&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-23">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-23"> 23&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-24">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-24"> 24&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-25">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-25"> 25&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-26">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-26"> 26&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-27">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-27"> 27&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-28">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-28"> 28&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-29">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-29"> 29&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-30">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-30"> 30&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-31">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-31"> 31&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-32">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-32"> 32&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-33">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-33"> 33&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-34">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-34"> 34&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-35">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-35"> 35&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-36">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-36"> 36&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-37">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-37"> 37&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-38">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-38"> 38&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-39">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-39"> 39&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-40">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-40"> 40&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-41">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-41"> 41&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-42">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-42"> 42&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-43">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-43"> 43&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-44">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-44"> 44&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-45">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-45"> 45&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-46">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-46"> 46&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-47">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-47"> 47&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-48">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-48"> 48&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-49">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-49"> 49&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-50">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-50"> 50&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-51">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-51"> 51&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-52">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-52"> 52&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-53">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-53"> 53&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-54">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-54"> 54&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-55">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-55"> 55&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-56">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-56"> 56&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-57">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-57"> 57&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-58">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-58"> 58&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-59">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-59"> 59&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-60">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-60"> 60&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-61">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-61"> 61&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-62">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-62"> 62&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-63">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-63"> 63&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-64">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-64"> 64&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-65">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-65"> 65&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-66">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-66"> 66&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-67">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-67"> 67&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-68">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-68"> 68&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-69">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-69"> 69&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-70">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-70"> 70&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-71">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-71"> 71&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-72">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-72"> 72&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-73">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-73"> 73&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-74">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-74"> 74&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-75">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-75"> 75&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-76">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-76"> 76&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-77">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-77"> 77&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-78">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-78"> 78&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-79">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-79"> 79&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-80">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-80"> 80&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-81">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-81"> 81&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-82">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-82"> 82&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-83">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-83"> 83&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-84">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-84"> 84&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-85">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-85"> 85&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-86">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-86"> 86&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-87">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-87"> 87&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-88">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-88"> 88&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-89">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-89"> 89&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-90">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-90"> 90&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-91">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-91"> 91&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-92">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-92"> 92&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-93">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-93"> 93&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-94">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-94"> 94&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-95">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-95"> 95&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-96">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-96"> 96&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-97">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-97"> 97&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-98">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-98"> 98&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-99">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-99"> 99&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-100">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-100">100&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-101">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-101">101&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-102">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-102">102&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-103">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-103">103&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-104">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-104">104&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-105">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-105">105&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-106">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-106">106&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-107">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-107">107&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-108">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-108">108&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-109">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-109">109&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-110">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-110">110&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-111">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-111">111&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-112">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-112">112&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-113">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-113">113&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-114">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-114">114&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-115">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-115">115&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-116">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-116">116&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-117">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-117">117&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-118">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-118">118&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-119">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-119">119&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-120">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-120">120&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-121">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-121">121&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-122">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-122">122&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-123">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-123">123&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-124">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-124">124&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-125">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-125">125&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-126">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-126">126&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-127">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-127">127&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-128">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-128">128&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-129">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-129">129&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-130">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-130">130&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-131">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-131">131&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-132">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-132">132&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-133">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-133">133&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-134">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-134">134&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-135">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-135">135&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-136">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-136">136&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-137">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-137">137&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-138">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-138">138&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-139">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-139">139&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-140">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-140">140&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-141">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-141">141&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-142">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-142">142&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-143">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-143">143&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-144">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-144">144&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-145">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-145">145&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-146">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-146">146&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-147">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-147">147&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-148">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-148">148&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-149">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-149">149&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-150">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-150">150&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-151">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-151">151&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-152">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-152">152&lt;/a>
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-153">&lt;a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-153">153&lt;/a>
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">import&lt;/span> &lt;span style="color:#0e84b5;font-weight:bold">tensorflow&lt;/span> &lt;span style="color:#007020;font-weight:bold">as&lt;/span> &lt;span style="color:#0e84b5;font-weight:bold">tf&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">from&lt;/span> &lt;span style="color:#0e84b5;font-weight:bold">tensorflow.examples.tutorials.mnist&lt;/span> &lt;span style="color:#007020;font-weight:bold">import&lt;/span> input_data
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>max_steps &lt;span style="color:#666">=&lt;/span> &lt;span style="color:#40a070">1000&lt;/span> &lt;span style="color:#60a0b0;font-style:italic"># 最大迭代次数&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>learning_rate &lt;span style="color:#666">=&lt;/span> &lt;span style="color:#40a070">0.001&lt;/span> &lt;span style="color:#60a0b0;font-style:italic"># 学习率&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dropout &lt;span style="color:#666">=&lt;/span> &lt;span style="color:#40a070">0.9&lt;/span> &lt;span style="color:#60a0b0;font-style:italic"># dropout时随机保留神经元的比例&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>data_dir &lt;span style="color:#666">=&lt;/span> &lt;span style="color:#4070a0">&amp;#39;./&amp;#39;&lt;/span> &lt;span style="color:#60a0b0;font-style:italic"># 样本数据存储的路径&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>log_dir &lt;span style="color:#666">=&lt;/span> &lt;span style="color:#4070a0">&amp;#39;./&amp;#39;&lt;/span> &lt;span style="color:#60a0b0;font-style:italic"># 输出日志保存的路径&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mnist &lt;span style="color:#666">=&lt;/span> input_data&lt;span style="color:#666">.&lt;/span>read_data_sets(data_dir, one_hot&lt;span style="color:#666">=&lt;/span>&lt;span style="color:#007020;font-weight:bold">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sess &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>InteractiveSession()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(&lt;span style="color:#4070a0">&amp;#39;input&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> x &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>placeholder(tf&lt;span style="color:#666">.&lt;/span>float32, [&lt;span style="color:#007020;font-weight:bold">None&lt;/span>, &lt;span style="color:#40a070">784&lt;/span>], name&lt;span style="color:#666">=&lt;/span>&lt;span style="color:#4070a0">&amp;#39;x-input&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> y_ &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>placeholder(tf&lt;span style="color:#666">.&lt;/span>float32, [&lt;span style="color:#007020;font-weight:bold">None&lt;/span>, &lt;span style="color:#40a070">10&lt;/span>], name&lt;span style="color:#666">=&lt;/span>&lt;span style="color:#4070a0">&amp;#39;y-input&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(&lt;span style="color:#4070a0">&amp;#39;input_reshape&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> image_shaped_input &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>reshape(x, [&lt;span style="color:#666">-&lt;/span>&lt;span style="color:#40a070">1&lt;/span>, &lt;span style="color:#40a070">28&lt;/span>, &lt;span style="color:#40a070">28&lt;/span>, &lt;span style="color:#40a070">1&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tf&lt;span style="color:#666">.&lt;/span>summary&lt;span style="color:#666">.&lt;/span>image(&lt;span style="color:#4070a0">&amp;#39;input&amp;#39;&lt;/span>, image_shaped_input, &lt;span style="color:#40a070">10&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">def&lt;/span> &lt;span style="color:#06287e">weight_variable&lt;/span>(shape):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4070a0">&amp;#34;&amp;#34;&amp;#34;Create a weight variable with appropriate initialization.&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> initial &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>truncated_normal(shape, stddev&lt;span style="color:#666">=&lt;/span>&lt;span style="color:#40a070">0.1&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">return&lt;/span> tf&lt;span style="color:#666">.&lt;/span>Variable(initial)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">def&lt;/span> &lt;span style="color:#06287e">bias_variable&lt;/span>(shape):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4070a0">&amp;#34;&amp;#34;&amp;#34;Create a bias variable with appropriate initialization.&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> initial &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>constant(&lt;span style="color:#40a070">0.1&lt;/span>, shape&lt;span style="color:#666">=&lt;/span>shape)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">return&lt;/span> tf&lt;span style="color:#666">.&lt;/span>Variable(initial)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">def&lt;/span> &lt;span style="color:#06287e">variable_summaries&lt;/span>(var):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4070a0">&amp;#34;&amp;#34;&amp;#34;Attach a lot of summaries to a Tensor (for TensorBoard visualization).&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(&lt;span style="color:#4070a0">&amp;#39;summaries&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#60a0b0;font-style:italic"># 计算参数的均值，并使用tf.summary.scaler记录&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mean &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>reduce_mean(var)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tf&lt;span style="color:#666">.&lt;/span>summary&lt;span style="color:#666">.&lt;/span>scalar(&lt;span style="color:#4070a0">&amp;#39;mean&amp;#39;&lt;/span>, mean)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#60a0b0;font-style:italic"># 计算参数的标准差&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(&lt;span style="color:#4070a0">&amp;#39;stddev&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> stddev &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>sqrt(tf&lt;span style="color:#666">.&lt;/span>reduce_mean(tf&lt;span style="color:#666">.&lt;/span>square(var &lt;span style="color:#666">-&lt;/span> mean)))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#60a0b0;font-style:italic"># 使用tf.summary.scaler记录记录下标准差，最大值，最小值&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tf&lt;span style="color:#666">.&lt;/span>summary&lt;span style="color:#666">.&lt;/span>scalar(&lt;span style="color:#4070a0">&amp;#39;stddev&amp;#39;&lt;/span>, stddev)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tf&lt;span style="color:#666">.&lt;/span>summary&lt;span style="color:#666">.&lt;/span>scalar(&lt;span style="color:#4070a0">&amp;#39;max&amp;#39;&lt;/span>, tf&lt;span style="color:#666">.&lt;/span>reduce_max(var))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tf&lt;span style="color:#666">.&lt;/span>summary&lt;span style="color:#666">.&lt;/span>scalar(&lt;span style="color:#4070a0">&amp;#39;min&amp;#39;&lt;/span>, tf&lt;span style="color:#666">.&lt;/span>reduce_min(var))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#60a0b0;font-style:italic"># 用直方图记录参数的分布&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tf&lt;span style="color:#666">.&lt;/span>summary&lt;span style="color:#666">.&lt;/span>histogram(&lt;span style="color:#4070a0">&amp;#39;histogram&amp;#39;&lt;/span>, var)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">def&lt;/span> &lt;span style="color:#06287e">nn_layer&lt;/span>(input_tensor, input_dim, output_dim, layer_name, act&lt;span style="color:#666">=&lt;/span>tf&lt;span style="color:#666">.&lt;/span>nn&lt;span style="color:#666">.&lt;/span>relu):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4070a0">&amp;#34;&amp;#34;&amp;#34;Reusable code for making a simple neural net layer.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4070a0"> It does a matrix multiply, bias add, and then uses relu to nonlinearize.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4070a0"> It also sets up name scoping so that the resultant graph is easy to read,
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4070a0"> and adds a number of summary ops.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4070a0"> &amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#60a0b0;font-style:italic"># 设置命名空间&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(layer_name):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#60a0b0;font-style:italic"># 调用之前的方法初始化权重w，并且调用参数信息的记录方法，记录w的信息&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(&lt;span style="color:#4070a0">&amp;#39;weights&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> weights &lt;span style="color:#666">=&lt;/span> weight_variable([input_dim, output_dim])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> variable_summaries(weights)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#60a0b0;font-style:italic"># 调用之前的方法初始化权重b，并且调用参数信息的记录方法，记录b的信息&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(&lt;span style="color:#4070a0">&amp;#39;biases&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> biases &lt;span style="color:#666">=&lt;/span> bias_variable([output_dim])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> variable_summaries(biases)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#60a0b0;font-style:italic"># 执行wx+b的线性计算，并且用直方图记录下来&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(&lt;span style="color:#4070a0">&amp;#39;linear_compute&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> preactivate &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>matmul(input_tensor, weights) &lt;span style="color:#666">+&lt;/span> biases
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tf&lt;span style="color:#666">.&lt;/span>summary&lt;span style="color:#666">.&lt;/span>histogram(&lt;span style="color:#4070a0">&amp;#39;linear&amp;#39;&lt;/span>, preactivate)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#60a0b0;font-style:italic"># 将线性输出经过激励函数，并将输出也用直方图记录下来&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> activations &lt;span style="color:#666">=&lt;/span> act(preactivate, name&lt;span style="color:#666">=&lt;/span>&lt;span style="color:#4070a0">&amp;#39;activation&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tf&lt;span style="color:#666">.&lt;/span>summary&lt;span style="color:#666">.&lt;/span>histogram(&lt;span style="color:#4070a0">&amp;#39;activations&amp;#39;&lt;/span>, activations)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#60a0b0;font-style:italic"># 返回激励层的最终输出&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">return&lt;/span> activations
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>hidden1 &lt;span style="color:#666">=&lt;/span> nn_layer(x, &lt;span style="color:#40a070">784&lt;/span>, &lt;span style="color:#40a070">500&lt;/span>, &lt;span style="color:#4070a0">&amp;#39;layer1&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(&lt;span style="color:#4070a0">&amp;#39;dropout&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> keep_prob &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>placeholder(tf&lt;span style="color:#666">.&lt;/span>float32)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tf&lt;span style="color:#666">.&lt;/span>summary&lt;span style="color:#666">.&lt;/span>scalar(&lt;span style="color:#4070a0">&amp;#39;dropout_keep_probability&amp;#39;&lt;/span>, keep_prob)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dropped &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>nn&lt;span style="color:#666">.&lt;/span>dropout(hidden1, keep_prob)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>y &lt;span style="color:#666">=&lt;/span> nn_layer(dropped, &lt;span style="color:#40a070">500&lt;/span>, &lt;span style="color:#40a070">10&lt;/span>, &lt;span style="color:#4070a0">&amp;#39;layer2&amp;#39;&lt;/span>, act&lt;span style="color:#666">=&lt;/span>tf&lt;span style="color:#666">.&lt;/span>identity)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(&lt;span style="color:#4070a0">&amp;#39;loss&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#60a0b0;font-style:italic"># 计算交叉熵损失（每个样本都会有一个损失）&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> diff &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>nn&lt;span style="color:#666">.&lt;/span>softmax_cross_entropy_with_logits(labels&lt;span style="color:#666">=&lt;/span>y_, logits&lt;span style="color:#666">=&lt;/span>y)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(&lt;span style="color:#4070a0">&amp;#39;total&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#60a0b0;font-style:italic"># 计算所有样本交叉熵损失的均值&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cross_entropy &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>reduce_mean(diff)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>tf&lt;span style="color:#666">.&lt;/span>summary&lt;span style="color:#666">.&lt;/span>scalar(&lt;span style="color:#4070a0">&amp;#39;loss&amp;#39;&lt;/span>, cross_entropy)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(&lt;span style="color:#4070a0">&amp;#39;train&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> train_step &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>train&lt;span style="color:#666">.&lt;/span>AdamOptimizer(learning_rate)&lt;span style="color:#666">.&lt;/span>minimize(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cross_entropy)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(&lt;span style="color:#4070a0">&amp;#39;accuracy&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(&lt;span style="color:#4070a0">&amp;#39;correct_prediction&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#60a0b0;font-style:italic"># 分别将预测和真实的标签中取出最大值的索引，弱相同则返回1(true),不同则返回0(false)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> correct_prediction &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>equal(tf&lt;span style="color:#666">.&lt;/span>argmax(y, &lt;span style="color:#40a070">1&lt;/span>), tf&lt;span style="color:#666">.&lt;/span>argmax(y_, &lt;span style="color:#40a070">1&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">with&lt;/span> tf&lt;span style="color:#666">.&lt;/span>name_scope(&lt;span style="color:#4070a0">&amp;#39;accuracy&amp;#39;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#60a0b0;font-style:italic"># 求均值即为准确率&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> accuracy &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>reduce_mean(tf&lt;span style="color:#666">.&lt;/span>cast(correct_prediction, tf&lt;span style="color:#666">.&lt;/span>float32))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>tf&lt;span style="color:#666">.&lt;/span>summary&lt;span style="color:#666">.&lt;/span>scalar(&lt;span style="color:#4070a0">&amp;#39;accuracy&amp;#39;&lt;/span>, accuracy)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#60a0b0;font-style:italic"># summaries合并&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>merged &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>summary&lt;span style="color:#666">.&lt;/span>merge_all()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#60a0b0;font-style:italic"># 写到指定的磁盘路径中&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>train_writer &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>summary&lt;span style="color:#666">.&lt;/span>FileWriter(log_dir &lt;span style="color:#666">+&lt;/span> &lt;span style="color:#4070a0">&amp;#39;/train&amp;#39;&lt;/span>, sess&lt;span style="color:#666">.&lt;/span>graph)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>test_writer &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>summary&lt;span style="color:#666">.&lt;/span>FileWriter(log_dir &lt;span style="color:#666">+&lt;/span> &lt;span style="color:#4070a0">&amp;#39;/test&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#60a0b0;font-style:italic"># 运行初始化所有变量&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>tf&lt;span style="color:#666">.&lt;/span>global_variables_initializer()&lt;span style="color:#666">.&lt;/span>run()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">def&lt;/span> &lt;span style="color:#06287e">feed_dict&lt;/span>(train):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4070a0">&amp;#34;&amp;#34;&amp;#34;Make a TensorFlow feed_dict: maps data onto Tensor placeholders.&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">if&lt;/span> train:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> xs, ys &lt;span style="color:#666">=&lt;/span> mnist&lt;span style="color:#666">.&lt;/span>train&lt;span style="color:#666">.&lt;/span>next_batch(&lt;span style="color:#40a070">100&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> k &lt;span style="color:#666">=&lt;/span> dropout
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">else&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> xs, ys &lt;span style="color:#666">=&lt;/span> mnist&lt;span style="color:#666">.&lt;/span>test&lt;span style="color:#666">.&lt;/span>images, mnist&lt;span style="color:#666">.&lt;/span>test&lt;span style="color:#666">.&lt;/span>labels
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> k &lt;span style="color:#666">=&lt;/span> &lt;span style="color:#40a070">1.0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">return&lt;/span> {x: xs, y_: ys, keep_prob: k}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007020;font-weight:bold">for&lt;/span> i &lt;span style="color:#007020;font-weight:bold">in&lt;/span> &lt;span style="color:#007020">range&lt;/span>(max_steps):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">if&lt;/span> i &lt;span style="color:#666">%&lt;/span> &lt;span style="color:#40a070">10&lt;/span> &lt;span style="color:#666">==&lt;/span> &lt;span style="color:#40a070">0&lt;/span>: &lt;span style="color:#60a0b0;font-style:italic"># 记录测试集的summary与accuracy&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> summary, acc &lt;span style="color:#666">=&lt;/span> sess&lt;span style="color:#666">.&lt;/span>run([merged, accuracy], feed_dict&lt;span style="color:#666">=&lt;/span>feed_dict(&lt;span style="color:#007020;font-weight:bold">False&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> test_writer&lt;span style="color:#666">.&lt;/span>add_summary(summary, i)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020">print&lt;/span>(&lt;span style="color:#4070a0">&amp;#39;Accuracy at step &lt;/span>&lt;span style="color:#70a0d0">%s&lt;/span>&lt;span style="color:#4070a0">: &lt;/span>&lt;span style="color:#70a0d0">%s&lt;/span>&lt;span style="color:#4070a0">&amp;#39;&lt;/span> &lt;span style="color:#666">%&lt;/span> (i, acc))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">else&lt;/span>: &lt;span style="color:#60a0b0;font-style:italic"># 记录训练集的summary&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">if&lt;/span> i &lt;span style="color:#666">%&lt;/span> &lt;span style="color:#40a070">100&lt;/span> &lt;span style="color:#666">==&lt;/span> &lt;span style="color:#40a070">99&lt;/span>: &lt;span style="color:#60a0b0;font-style:italic"># Record execution stats&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> run_options &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>RunOptions(trace_level&lt;span style="color:#666">=&lt;/span>tf&lt;span style="color:#666">.&lt;/span>RunOptions&lt;span style="color:#666">.&lt;/span>FULL_TRACE)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> run_metadata &lt;span style="color:#666">=&lt;/span> tf&lt;span style="color:#666">.&lt;/span>RunMetadata()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> summary, _ &lt;span style="color:#666">=&lt;/span> sess&lt;span style="color:#666">.&lt;/span>run([merged, train_step],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> feed_dict&lt;span style="color:#666">=&lt;/span>feed_dict(&lt;span style="color:#007020;font-weight:bold">True&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> options&lt;span style="color:#666">=&lt;/span>run_options,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> run_metadata&lt;span style="color:#666">=&lt;/span>run_metadata)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> train_writer&lt;span style="color:#666">.&lt;/span>add_run_metadata(run_metadata, &lt;span style="color:#4070a0">&amp;#39;step&lt;/span>&lt;span style="color:#70a0d0">%03d&lt;/span>&lt;span style="color:#4070a0">&amp;#39;&lt;/span> &lt;span style="color:#666">%&lt;/span> i)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> train_writer&lt;span style="color:#666">.&lt;/span>add_summary(summary, i)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020">print&lt;/span>(&lt;span style="color:#4070a0">&amp;#39;Adding run metadata for&amp;#39;&lt;/span>, i)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007020;font-weight:bold">else&lt;/span>: &lt;span style="color:#60a0b0;font-style:italic"># Record a summary&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> summary, _ &lt;span style="color:#666">=&lt;/span> sess&lt;span style="color:#666">.&lt;/span>run([merged, train_step], feed_dict&lt;span style="color:#666">=&lt;/span>feed_dict(&lt;span style="color:#007020;font-weight:bold">True&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> train_writer&lt;span style="color:#666">.&lt;/span>add_summary(summary, i)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>train_writer&lt;span style="color:#666">.&lt;/span>close()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>test_writer&lt;span style="color:#666">.&lt;/span>close()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item></channel></rss>