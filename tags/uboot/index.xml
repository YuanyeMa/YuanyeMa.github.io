<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Uboot on Yuanye Ma's Blog</title><link>/tags/uboot/</link><description>Recent content in Uboot on Yuanye Ma's Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><managingEditor>yuanye.ma@qq.com (Yuanye Ma)</managingEditor><webMaster>yuanye.ma@qq.com (Yuanye Ma)</webMaster><lastBuildDate>Tue, 06 Mar 2018 16:01:23 +0800</lastBuildDate><atom:link href="/tags/uboot/index.xml" rel="self" type="application/rss+xml"/><item><title>uboot</title><link>/post/embeeding/uboot/</link><pubDate>Tue, 06 Mar 2018 16:01:23 +0800</pubDate><author>yuanye.ma@qq.com (Yuanye Ma)</author><guid>/post/embeeding/uboot/</guid><description>&lt;h1 id="uboot"&gt;uboot&lt;/h1&gt;
&lt;h2 id="make-xxx_defconfig"&gt;make xxx_defconfig&lt;/h2&gt;
&lt;h3 id="top-makefile--config"&gt;Top Makefile : %config&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;依赖&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;scripts_basic&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$(Q)$(MAKE) $(build)=scripts/basic&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;$(build) 定义在 scripts/Kbuild.include中&lt;/p&gt;
&lt;p&gt;build := -f $(srctree)/scripts/Makefile.build obj&lt;/p&gt;
&lt;p&gt;即 命令展开为 @ make -f $(srctree)/scripts/Makefile.build obj=scripts/basic&lt;/p&gt;
&lt;p&gt;编译生成了 scripts/basic/fixdep&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;outputmakefile&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;FORCE&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;命令&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$(Q)$(MAKE) $(build)=scripts/kconfig $@
展开为 @ make -f $(srctree)/scripts/Makefile.build obj=scripts/kconfig xxx_defconfig&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;src = scripts/kconf&lt;/p&gt;
&lt;p&gt;kbuild-dir = scripts/kconf&lt;/p&gt;
&lt;p&gt;kbuild-file = scripts/kconf/Makefile&lt;/p&gt;
&lt;p&gt;include scripts/kconf/Makefile # xxx_defconfig 目标定义在这个文件中&lt;/p&gt;
&lt;p&gt;%_defconfig: $(obj)/conf &lt;br&gt;
$(Q)$&amp;lt; $(silent) &amp;ndash;defconfig=arch/$(SRCARCH)/configs/$@ $(Kconfig)&lt;/p&gt;
&lt;p&gt;$&amp;lt;表示第一个依赖文件， $^ 表示所有依赖文件， $@ 表示目标&lt;/p&gt;
&lt;p&gt;即展开为 @scripts/kconfig/conf -s &amp;ndash;defconfig=arch/$(SRCARCH)/configs/xxx_defconfig $(Kconfig)&lt;/p&gt;
&lt;p&gt;通过&lt;a href="https://blog.csdn.net/guyongqiangx/article/details/52679635"&gt;对conf源码的分析&lt;/a&gt;，大概知道conf程序用于维护 .config ，&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;如果传入了&amp;ndash;defconfig参数就读取 Kconfig文件生成 .config文件&lt;/li&gt;
&lt;li&gt;如果传入了 &amp;ndash;silentoldconfig （在make 整个u-boot时）则生成以下文件
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;include/generated/autoconf.h&lt;/code&gt; 是C语言头文件，主要影响C语言编译过程。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;include/config/auto.conf.cmd&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;include/config/tristate.conf&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;include/config/auto.conf&lt;/code&gt; 被顶层Makefile包含，影响编译过程。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="make"&gt;make&lt;/h2&gt;
&lt;p&gt;&lt;img src="/post/embeeding/uboot/uboot-make.png" alt="uboot-make"&gt;&lt;/p&gt;</description></item></channel></rss>